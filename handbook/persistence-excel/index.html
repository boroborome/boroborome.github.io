<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>persistence-excel | Hello Happy3w</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.992cb7aa.css" as="style"><link rel="preload" href="/assets/js/app.3648f115.js" as="script"><link rel="preload" href="/assets/js/2.ea5800c7.js" as="script"><link rel="preload" href="/assets/js/11.d64b6e9f.js" as="script"><link rel="prefetch" href="/assets/js/10.8b96c1cc.js"><link rel="prefetch" href="/assets/js/12.59b41936.js"><link rel="prefetch" href="/assets/js/13.b8edde7e.js"><link rel="prefetch" href="/assets/js/3.a969e1d2.js"><link rel="prefetch" href="/assets/js/4.08d94035.js"><link rel="prefetch" href="/assets/js/5.b3c393a9.js"><link rel="prefetch" href="/assets/js/6.269a2766.js"><link rel="prefetch" href="/assets/js/7.eb9feba6.js"><link rel="prefetch" href="/assets/js/8.e342df7d.js"><link rel="prefetch" href="/assets/js/9.d8cce6b4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.992cb7aa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Hello Happy3w</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/handbook/" class="nav-link router-link-active">
  手册
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/handbook/" class="nav-link router-link-active">
  手册
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/handbook/" aria-current="page" class="sidebar-link">手册概览</a></li><li><a href="/handbook/toolkits/" class="sidebar-link">toolkits</a></li><li><a href="/handbook/persistence-core/" class="sidebar-link">persistence-core</a></li><li><a href="/handbook/persistence-jpa/" class="sidebar-link">persistence-jpa</a></li><li><a href="/handbook/persistence-es/" class="sidebar-link">persistence-es</a></li><li><a href="/handbook/persistence-excel/" aria-current="page" class="active sidebar-link">persistence-excel</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/handbook/persistence-excel/#quick-start" class="sidebar-link">Quick Start</a></li><li class="sidebar-sub-header"><a href="/handbook/persistence-excel/#maven-gradle-configuration" class="sidebar-link">Maven/Gradle configuration</a></li><li class="sidebar-sub-header"><a href="/handbook/persistence-excel/#组件介绍" class="sidebar-link">组件介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/handbook/persistence-excel/#sheetpage" class="sidebar-link">SheetPage</a></li><li class="sidebar-sub-header"><a href="/handbook/persistence-excel/#excelassistant" class="sidebar-link">ExcelAssistant</a></li></ul></li><li class="sidebar-sub-header"><a href="/handbook/persistence-excel/#历史" class="sidebar-link">历史</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/handbook/persistence-excel/#_0-0-4" class="sidebar-link">0.0.4</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="persistence-excel"><a href="#persistence-excel" class="header-anchor">#</a> persistence-excel</h1> <h2 id="quick-start"><a href="#quick-start" class="header-anchor">#</a> Quick Start</h2> <h2 id="maven-gradle-configuration"><a href="#maven-gradle-configuration" class="header-anchor">#</a> Maven/Gradle configuration</h2> <p>Add the Maven dependency:</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.happy3w<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>persistence-excel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.0.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Add the Gradle dependency:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>implementation <span class="token string">'com.happy3w:persistence-excel:0.0.4'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="组件介绍"><a href="#组件介绍" class="header-anchor">#</a> 组件介绍</h2> <ul><li>SheetPage Excel Sheet页</li> <li>ExcelAssistant Excel功能助手</li></ul> <hr> <h3 id="sheetpage"><a href="#sheetpage" class="header-anchor">#</a> SheetPage</h3> <p>这里是一个Demo，先定义自己的数据结构</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyData</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@ObjRdColumn</span><span class="token punctuation">(</span><span class="token string">&quot;名字&quot;</span><span class="token punctuation">)</span>      <span class="token comment">// 声明Excel中的标题</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ObjRdColumn</span><span class="token punctuation">(</span><span class="token string">&quot;年龄&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>写Excel的逻辑</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyData</span><span class="token punctuation">&gt;</span></span> dataList <span class="token operator">=</span> <span class="token function">getDatas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//拿到需要操作的数据</span>

<span class="token comment">// 创建Excel workbook，以及用于保存数据的sheet页</span>
<span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">ExcelUtil</span><span class="token punctuation">.</span><span class="token function">newXlsWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SheetPage</span> page <span class="token operator">=</span> <span class="token class-name">SheetPage</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token string">&quot;test-page&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 生成数据定义，并将数据写入到page中</span>
<span class="token class-name">ObjRdTableDef</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyData</span><span class="token punctuation">&gt;</span></span> tableDef <span class="token operator">=</span> <span class="token class-name">ObjRdTableDef</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">MyData</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">RdAssistant</span><span class="token punctuation">.</span><span class="token function">writeObj</span><span class="token punctuation">(</span>dataList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> page<span class="token punctuation">,</span> tableDef<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将Excel写入到文件</span>
workbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>excelFile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>读Excel数据</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 打开excel文件，并获取包含数据的sheet页test-page</span>
<span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">ExcelUtil</span><span class="token punctuation">.</span><span class="token function">openWorkbook</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>excelFile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SheetPage</span> page <span class="token operator">=</span> <span class="token class-name">SheetPage</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token string">&quot;test-page&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 读取所有数据</span>
<span class="token class-name">MessageRecorder</span> messageRecorder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageRecorder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyData</span><span class="token punctuation">&gt;</span></span> datas <span class="token operator">=</span> <span class="token class-name">RdAssistant</span><span class="token punctuation">.</span><span class="token function">readObjs</span><span class="token punctuation">(</span>objRdTableDef<span class="token punctuation">,</span> page<span class="token punctuation">,</span> messageRecorder<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

messageRecorder<span class="token punctuation">.</span><span class="token function">getErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 所有解析文件过程中的错误信息</span>
messageRecorder<span class="token punctuation">.</span><span class="token function">isSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 检测解析过程是否成功</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>MessageRecorder的用法可以参见 https://github.com/boroborome/toolkits#messagerecorder-%E7%BB%84%E4%BB%B6</p> <p>ObjRdTableDef的使用方法参见 https://github.com/boroborome/persistence-core#objrdtabledef</p> <h4 id="扩展数据类型转换规则"><a href="#扩展数据类型转换规则" class="header-anchor">#</a> 扩展数据类型转换规则</h4> <p>SheetPage默认使用系统toolkits中默认TypeConverter实例转换数据的副本，如果转换数据有自己的要求，可以直接设置新的typeConverter。</p> <h4 id="扩展不同数据类型的读写方式"><a href="#扩展不同数据类型的读写方式" class="header-anchor">#</a> 扩展不同数据类型的读写方式</h4> <p>SheetPage.cellAccessManager负责配置如何将不同数据类型读写到一个单元格中，</p> <p>系统默认支持了String、Long、Integer、Date，如果出现其他自己的类型，可以扩展这个cellAccessManager</p> <p>默认情况SheetPage.cellAccessManager会从CellAccessManager.INSTANCE复制一份，因此可以配置全局的CellAccessManager.INSTANCE来让有所的SheetPage生效。也可以单独修改一个SheetPage实例的cellAccessManager。举例说明如何实现新的ICellAccessor</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 这是负责读写Double类型的Accessor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DoubleCellAccessor</span> <span class="token keyword">implements</span> <span class="token class-name">ICellAccessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token comment">// 将值写入一个单元格</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">Cell</span> cell<span class="token punctuation">,</span> <span class="token class-name">Double</span> value<span class="token punctuation">,</span> <span class="token class-name">ExtConfigs</span> extConfigs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 从给定的cell读取一个Double类型数据</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Double</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token class-name">Cell</span> cell<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> valueType<span class="token punctuation">,</span> <span class="token class-name">ExtConfigs</span> extConfigs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CellType</span><span class="token punctuation">.</span>BLANK<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getCellTypeEnum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> cell<span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> <span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 在适当的实际将这个CellAccessor添加到管理器</span>
<span class="token class-name">CellAccessManager</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">.</span><span class="token function">registItem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DoubleCellAccessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="扩展excel支持的irdconfig"><a href="#扩展excel支持的irdconfig" class="header-anchor">#</a> 扩展Excel支持的IRdConfig</h4> <p>SheetPage支持的IRdConfig配置类型，可以通过SheetPage.regRdConfigInfo方法增加或者修改。</p> <p>如果需要修改默认值，可以直接修改RdciHolder.ALL_CONFIG_INFOS。</p> <p>一个RdConfigInfo是一个让SheetPage认识IRdConfig的配置信息，详细描述如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 配置处理信息。SheetPage用这些信息让各种配置在Excel上生效
 * @param &lt;VT&gt; 需要处理数据的数据类型
 * @param &lt;CT&gt; 对应配置的类型
 */</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">RdConfigInfo</span><span class="token generics"><span class="token punctuation">&lt;</span>VT<span class="token punctuation">,</span> CT <span class="token keyword">extends</span> <span class="token class-name">IRdConfig</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">ITypeItem</span><span class="token generics"><span class="token punctuation">&lt;</span>VT<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 需要处理数据的数据类型。如果对数据没有要求就填写Void.class。在同一个单元格上非Void.class的配置信息之间会只有一个生效。系统会根据优先级在其中选择一个。
     */</span>
    <span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span>VT<span class="token punctuation">&gt;</span></span> type<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 对应配置的类型。
     */</span>
    <span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span>CT<span class="token punctuation">&gt;</span></span> configType<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">RdConfigInfo</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span>CT<span class="token punctuation">&gt;</span></span> configType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>configType<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">RdConfigInfo</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span>CT<span class="token punctuation">&gt;</span></span> configType<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span>VT<span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>configType <span class="token operator">=</span> configType<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>isDataFormat <span class="token operator">=</span> type <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> type <span class="token operator">!=</span> <span class="token class-name">Void</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token operator">&amp;&amp;</span> type <span class="token operator">!=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 标示当前配置是否属于格式配置&lt;br&gt;
     *     一个Cell上只能有一个格式配置，因此，多个格式配置之间互相冲突。使用的时候只有优先级最高的生效&lt;br&gt;
     *     生效顺序：Cell上配置、Column配置、Sheet上配置。分别对应某次写入时特别指定的配置，字段上的注解，类上的注解与Page上的配置。
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> isDataFormat<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 将这个配置应用到CellStyle上
     * @param cellStyle 等待配置的cellStyle
     * @param rdConfig 需要配置到cellStyle上的配置信息
     * @param bsc 包含当前单元格信息的一些上下文
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">buildStyle</span><span class="token punctuation">(</span><span class="token class-name">CellStyle</span> cellStyle<span class="token punctuation">,</span> <span class="token class-name">CT</span> rdConfig<span class="token punctuation">,</span> <span class="token class-name">BuildStyleContext</span> bsc<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>当前只有DateFormatCfg和NumFormatCfg的配置信息属于数据格式类配置，其他都是普通的样式配置。</p> <h4 id="扩展excel特有的配置"><a href="#扩展excel特有的配置" class="header-anchor">#</a> 扩展Excel特有的配置</h4> <p>当前工具只增加了下面注解</p> <ul><li>FillForegroundColor
背景色配置。支持的颜色定义在HssfColor</li> <li>FillPattern
背景填充方式配置。一般使用FillPatternType.SOLID_FOREGROUND。</li></ul> <p>如果需要扩展，可以自行实现。</p> <ul><li>在代码中实现自己的注解和配置，参见 https://github.com/boroborome/persistence-core#%E6%89%A9%E5%B1%95%E6%B3%A8%E8%A7%A3</li> <li>实现新注解的RdConfigInfo。参见上面《扩展Excel支持的IRdConfig》</li></ul> <h3 id="excelassistant"><a href="#excelassistant" class="header-anchor">#</a> ExcelAssistant</h3> <p>通过ExcelAssistant可以读取所有Sheet页内容</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 打开excel文件，</span>
<span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">ExcelUtil</span><span class="token punctuation">.</span><span class="token function">openWorkbook</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>excelFile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 读取所有Sheet页中数据。要求每页都有标题，各页的标题顺序可以不同</span>
<span class="token class-name">MessageRecorder</span> messageRecorder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageRecorder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyData</span><span class="token punctuation">&gt;</span></span> datas <span class="token operator">=</span> <span class="token class-name">ExcelAssistant</span><span class="token punctuation">.</span><span class="token function">readRows</span><span class="token punctuation">(</span>objRdTableDef<span class="token punctuation">,</span> workbook<span class="token punctuation">,</span> messageRecorder<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="历史"><a href="#历史" class="header-anchor">#</a> 历史</h2> <h3 id="_0-0-4"><a href="#_0-0-4" class="header-anchor">#</a> 0.0.4</h3> <ul><li>升级libs，修复数据转换的bug</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/handbook/persistence-es/" class="prev">
        persistence-es
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3648f115.js" defer></script><script src="/assets/js/2.ea5800c7.js" defer></script><script src="/assets/js/11.d64b6e9f.js" defer></script>
  </body>
</html>
